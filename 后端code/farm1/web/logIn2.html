<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智农慧通-账户登录</title>
    <link rel="icon" href="favicon.ico">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- <link href="css/logIn.css" rel="stylesheet">
    <script src="js/logIn.js"></script> -->

</head>

<body>
    <div id="up-nav">
        <div class="container over-clear">
            <div class="fleft left-div">
                <span class="tag">欢迎来到智农慧通</span>
                <div class="beforeLogin">
                    <span class="iconfont icon">&#xe651;</span>
                    <span class="login"><a href="./logIn.html">注册登录</a></span>
                </div>
                <div class="afterLogin">
                    <span class="iconfont icon">&#xe651;</span>
                    <span class="userName">简小橘</span>
                    <span class="exit">退出</span>
                </div>
            </div>
            <div class="fright right-div">
                <span class="new-store"><a href="#">我要入驻开店</a></span>
                <span class="iconfont tag">&#xe63b;</span>
                <span class="person-Center"><a href="#">个人中心</a></span>
                <span class="iconfont tag">&#xe63b;</span>
                <span class="backstore"><a href="#">供应商后台</a></span>
            </div>
        </div>
    </div>

    <div class="wrap">
        <div class="top-div">
            <div class="logo">
                <h1><a href="./index.html">智农慧通</a></h1>
            </div>
        </div>
        <div class="pic">
            <img src="./images/login.jpg">
            <div class="logInBox">
                <h2>用户登录</h2>
                <form target="the_iframe">
                    <div class="form-group">
                        <label for="account" class="sr-only">账号</label>
                        <input type="text" class="form-control" id="account" placeholder="邮箱/手机号">
                    </div>
                    <div class="form-group">
                        <label for="password" class="sr-only">密码</label>
                        <input type="password" class="form-control" id="password" placeholder="密码">
                    </div>
                    <div class="error1">
                        <i class="iconfont">&#xe690;</i>
                        <span>账号或密码错误，请重新输入</span>
                    </div>
                    <div class="error2">
                        <i class="iconfont">&#xe690;</i>
                        <span>输入账号格式不对，请重新输入</span>
                    </div>

                    <button class="btn btn-success">
                        <span>登</span><span>录</span>
                    </button>
                    <div class="signIn">
                        <div>
                            <i class="iconfont">&#xe635;</i>
                            <a href="signIn.jsp">立即注册</a>
                        </div>
                    </div>
                </form>
                <iframe id="is_iframe" name="the_iframe" style="display:none;"></iframe>
            </div>
        </div>
        <div id="footer">
            <div><span>豫ICP备13007354号-1 | 服务热线：400-009-8699</span></div>
            <div><span>互联网药品信息服务资格证书:(湘)-经营性-2020-0005 河南智农慧通科技有限公司
                营业执照号</span></div>
            <div><span>增值电信业务经营许可证：经营许可证编号：豫B2-20130072</span></div>
            <div><span>©-2020 Cnhnb B2B SYSTEM All Rights Reserved</span></div>
            <div><img src="./images/footer.png" alt="行业认证"></div>
        </div>
    </div>
    <script>
        $(function() {

            $('#account').on('change', function() {

                let account = $(this).val();
                if (account.trim() == '') { // 如果输入位空串 则 让提示消失
                    //  $('.logInBox .error2').css('display', 'none');
                    return false;
                }
                let reg1 = new RegExp(/^[0-9]{11}$/); // 电话号
                let reg2 = new RegExp(/^[\w-\.]+@[\w-\.]+(\.[\w-\.]+)+$/); // 邮箱
                let reg3 = new RegExp(/^(?=.*([a-zA-Z]|[\u4E00-\u9FA5\uf900-\ufa2d]))[a-zA-Z0-9\u4E00-\u9FA5\uf900-\ufa2d]{2,20}$/); //用户名
                if (!reg1.test(account) && !reg2.test(account) && !reg3.test(account)) {
                    $('.logInBox .error2').css('display', 'block');
                } else {
                    console.log('账号格式正确');
                    $('.logInBox .error2').css('display', 'none');
                }
            });
            $('#account').on('input propertychange', function() {
                let account = $(this).val();
                if (account.trim() == '') {
                    $(this).val(''); // 如果有空格则置为空
                    $('.logInBox .error2').css('display', 'none');
                }
            });

            $('.logInBox form>button').eq(0).on('click', function() {

                let UserID = $('#account').val();
                let password = $('#password').val();


                let success = function(data) {
                    //  if (data.code == 200) {
                    //     if()
                    //  } else {
                    //      alert("服务器出错请稍后再试");
                    //  }
                    //  if (data. == 'fail') {
                    //      $('.logInBox .error1').css('display', 'block');
                    //  } else {
                    //      window.location.href = './index.html';
                    //  }
                    console.log(data);
                    console.log(data.code);
                }
                let data = {
                    UserID: UserID,
                    password: password
                };
                $.ajax({
                    type: 'post',
                    url: "http://172.32.100.201:8080/farm1/userServlet/login",
                    //  url: "http://172.32.187.96:8000/server",
                    //  dataType: 'json',
                    data: data,
                    success: success,
                    // 设置超时时间
                    timeout: 10000,
                    error: function() {
                        alert("访问超时或异常，请稍后重试");
                    }
                });
            });

        });
    </script>
</body>

</html>